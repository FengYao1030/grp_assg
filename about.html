<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>CrimeMY - About</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/favicon2.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Nunito:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson-client@3"></script>

</head>

<body class="about-page">

  <header id="header" class="header d-flex align-items-center sticky-top">
    <div class="container position-relative d-flex align-items-center">
      <a href="index.html" class="logo d-flex align-items-center me-auto">
        <h1 class="sitename">CrimeMY</h1>
      </a>
      <nav id="navmenu" class="navmenu" aria-label="Main navigation">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html" class="active" aria-current="page">About</a></li>
          <li><a href="crime.html">Crime Types</a></li>
          <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="casestudies.html">Case Studies</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list" aria-label="Open main menu" aria-controls="navmenu"
          aria-expanded="false"></i>
      </nav>
    </div>
  </header>

  <main class="main">

    <!-- About Section -->
    <section id="about" class="about section">
      <div class="ner-fluid px-4 px-md-5">
        <div class="row align-items-center gx-4">

          <!-- Left Side: Images -->
          <div class="col-12 col-md-6">
            <div class="about-img mb-3">
              <img src="assets/img/crime1.png" class="img-fluid rounded shadow-sm" alt="Major Crime News in Malaysia">
            </div>
            <div class="about-img">
              <img src="assets/img/crime2.png" class="img-fluid rounded shadow-sm" alt="Crime Scene in Malaysia">
            </div>
          </div>

          <!-- Right Side: Text -->
          <div class="col-12 col-md-6" style="text-align: justify;">
            <h2>About Malaysia Crime</h2>
            <p>
              Our platform provides an in-depth look into crime trends and statistics in Malaysia.
              We feature comprehensive <strong>case studies</strong> of notable incidents, an overview of
              different <strong>types of crime</strong> occurring across the country, and an interactive
              <strong>dashboard</strong> to explore crime records and probabilities.
            </p>
            <p>
              By combining real data and case analysis, our goal is to raise public awareness and
              support crime prevention efforts nationwide.
            </p>

            <!-- Key Facts -->
            <h4 class="mt-4">Key Crime Facts (2024)</h4>
            <ul>
              <li>üìä <strong>27,900+ </strong> total reported crimes in Malaysia</li>
              <li>üö® Most common crimes: theft, burglary, drug trafficking</li>
              <li>üìç Highest rates in Kuala Lumpur, Selangor, Johor</li>
              <li>üëÆ‚Äç‚ôÇÔ∏è Police response time average: <strong> 10‚Äì15 mins</strong></li>
            </ul>

            <!-- Button -->
            <div class="mt-4">
              <a href="casestudies.html" class="btn btn-custom-primary me-2">View Case Studies</a>
              <a href="dashboard.html" class="btn btn-custom-outline">Explore Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--chart-->

    <!-- Libraries 
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.1/papaparse.min.js"></script>
-->
    <section id="crime-map-section" class="section-bg py-5">
      <div class="container-fluid px-4 px-md-5">

        <div class="row justify-content-center">
          <div class="col-lg-12">
            <h2 class="text-center" style="padding-bottom: 10px; font-weight: bold;">Malaysia Crime Map: Average Yearly
              Cases (2016‚Äì2023)</h2>
            <div id="map-table-error" style="display: none;">
              <div class="alert alert-danger" role="alert">
                <p class="mb-0"><strong>Malaysia Crime Map Unavailable.</strong> Could
                  not load data for the Malaysia Crime Map.</p>
              </div>
            </div>
            <div class="map-wrapper">
              <div style="position: relative; width: 100%; padding-bottom: 75%; height: 0;">
                <svg id="malaysia-map" style="position:absolute;top:0;left:0;width:100%;height:100%;"></svg>
              </div>
              <div id="tooltip" class="tooltip"></div>
            </div>
            <p style="font-style: italic; text-align: center;">
              ** This map visualizes the average yearly crime cases in each Malaysian state from 2016 to
              2023. Hover over a state to see the average number of cases reported annually.</p>
          </div>
        </div>
      </div>
    </section>



    <!--End Chart-->
  </main>

  <footer id="footer" class="footer dark-background">
    <div class="container footer-top">
      <div class="row gy-4">
        <div class="col-lg-4 col-md-6 footer-about">
          <a href="index.html" class="logo d-flex align-items-center">
            <span class="sitename">CrimeMY</span>
          </a>
          <div class="footer-contact pt-3">
            <p>1, Jln BU 3/1, Bandar Utama, 47800 </p>
            <p>Petaling Jaya, Selangor</p>
            <p class="mt-3"><strong>Emergency:</strong> <span>60189815566</span></p>
            <p><strong>Email:</strong> <span>contact@crimemy.my </span></p>
          </div>
        </div>

        <div class="col-lg-2 col-md-3 footer-links">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </div>

        <div class="col-lg-2 col-md-3 footer-links">
          <h4>Resources</h4>
          <ul>
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="crime.html">Crime Types</a></li>
            <li><a href="casestudies.html">Case Studies</a></li>
          </ul>
        </div>

        <div class="col-lg-4 col-md-12 footer-newsletter">
          <h4>Crime Alert Newsletter</h4>
          <p>Subscribe to receive updates on local crime trends and prevention tips in your area.</p>
          <form id="newsletter-form" action="forms/newsletter.php" method="post" class="php-email-form"
            aria-label="Crime Alert Newsletter">
            <div class="newsletter-form">
              <input type="email" name="email" placeholder="Your Email" required>
              <input type="submit" value="Subscribe">
            </div>
            <div class="sent-message">Your subscription request has been sent. Thank you!</div>
          </form>
        </div>
      </div>
    </div>

    <div class="container copyright text-center mt-4">
      <p>¬© <span>Copyright</span> <strong class="px-1 sitename">CrimeMY</strong> <span>All Rights Reserved</span>
      </p>
    </div>
  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short" aria-hidden="true"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>
  <!-- 
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>
 -->
  <script>
    document.getElementById('newsletter-form').addEventListener('submit', function (event) {
      event.preventDefault();
      const emailInput = this.querySelector('input[name="email"]');
      const email = emailInput.value;
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

      if (emailRegex.test(email)) {
        // Hide form and show success message
        this.querySelector('.newsletter-form').classList.add('hidden');
        this.querySelector('.sent-message').classList.add('visible');

        // Reset form
        this.reset();
      }
    });

    document.addEventListener('DOMContentLoaded', function () {
      const svg = d3.select("#malaysia-map");
      const tooltip = d3.select("#tooltip");

      const projection = d3.geoMercator();
      const path = d3.geoPath().projection(projection);

      Promise.all([
        d3.json("https://raw.githubusercontent.com/codeforamerica/click_that_hood/master/public/data/malaysia.geojson"),
        d3.csv("data/chartdata.csv")
      ]).then(([mapData, csvData]) => {

        function getCsvName(mapName) {
          const nameMapping = {
            "Kuala Lumpur": "W.P. Kuala Lumpur",
            "Federal Territory of Kuala Lumpur": "W.P. Kuala Lumpur",
            "Putrajaya": "W.P. Putrajaya",
            "Federal Territory of Putrajaya": "W.P. Putrajaya",
            "Labuan": "W.P. Labuan",
            "Federal Territory of Labuan": "W.P. Labuan",
            "Penang": "Pulau Pinang",
            "Negeri Sembilan Darul Khusus": "Negeri Sembilan"
          };
          return nameMapping[mapName] || mapName;
        }

        const filteredData = csvData.filter(d => d.state !== "Malaysia");

        const crimesByStateAvg = d3.rollup(
          filteredData,
          v => {
            const total = d3.sum(v, d => +d.crimes || 0);
            const years = new Set(v.map(d => d.date.substring(0, 4))).size;
            return Math.round(total / (years || 1));
          },
          d => d.state
        );

        const maxCrimes = d3.max([...crimesByStateAvg.values()]);

        const colorScale = d3.scaleThreshold()
          .domain([
            0.2 * maxCrimes,
            0.4 * maxCrimes,
            0.6 * maxCrimes,
            0.8 * maxCrimes
          ])
          .range(["#1f77b4", "#2ca02c", "#ffcc00", "#ff7f0e", "#d62728"]);

        function drawMap() {
          const container = document.querySelector(".map-wrapper");
          const width = container.clientWidth;
          const height = width * 0.65;

          svg.attr("width", width).attr("height", height);
          projection.fitSize([width, height], mapData);


          // --- Draw States ---
          const states = svg.selectAll("path")
            .data(mapData.features, d => d.properties.name);

          states.join("path")
            .attr("d", path)
            .attr("fill", d => {
              const csvStateName = getCsvName(d.properties.name);
              return crimesByStateAvg.has(csvStateName)
                ? colorScale(crimesByStateAvg.get(csvStateName))
                : "#eee";
            })
            .attr("stroke", "#fff")
            .attr("stroke-width", 1)
            .on("mouseover", function () {
              tooltip.style("opacity", 1);
              d3.select(this).attr("stroke", "black").attr("stroke-width", 2);
            })
            .on("mousemove", function (event, d) {
              const csvStateName = getCsvName(d.properties.name);

              if (crimesByStateAvg.has(csvStateName)) {
                const avgCrimes = crimesByStateAvg.get(csvStateName);
                tooltip.html(`<strong>${d.properties.name}</strong><br>Avg. Yearly Cases: ${avgCrimes.toLocaleString()}`);
              } else {
                tooltip.html(`<strong>${d.properties.name}</strong><br><em>No data available</em>`);
              }

              tooltip
                .style("left", (event.pageX + 15) + "px")
                .style("top", (event.pageY - 30) + "px");
            })
            .on("mouseout", function () {
              tooltip.style("opacity", 0);
              d3.select(this).attr("stroke", "#fff").attr("stroke-width", 1);
            });

          // --- Draw Legend ---
          svg.selectAll(".legend").remove(); // clear old legend

          const isSmallScreen = width < 768;

          const legendWidth = isSmallScreen ? width * 0.95 : Math.min(700, width * 0.9);
          const legendItemWidth = legendWidth / 5;

          const legendRanges = [
            { color: "#1f77b4", label: `0 ‚Äì ${Math.round(0.2 * maxCrimes).toLocaleString()}` },
            { color: "#2ca02c", label: `${Math.round(0.2 * maxCrimes + 1).toLocaleString()} ‚Äì ${Math.round(0.4 * maxCrimes).toLocaleString()}` },
            { color: "#ffcc00", label: `${Math.round(0.4 * maxCrimes + 1).toLocaleString()} ‚Äì ${Math.round(0.6 * maxCrimes).toLocaleString()}` },
            { color: "#ff7f0e", label: `${Math.round(0.6 * maxCrimes + 1).toLocaleString()} ‚Äì ${Math.round(0.8 * maxCrimes).toLocaleString()}` },
            { color: "#d62728", label: `> ${Math.round(0.8 * maxCrimes).toLocaleString()}` }
          ];

          const legendY = isSmallScreen ? height - 55 : height - 30;
          const titleFontSize = isSmallScreen ? "18px" : "24px";
          const labelFontSize = isSmallScreen ? "10px" : "16px";
          const titleY = isSmallScreen ? -8 : -15;
          const labelY = isSmallScreen ? 22 : 28;

          const legend = svg.append("g")
            .attr("class", "legend")
            .attr("transform", `translate(${width / 2 - legendWidth / 2}, ${legendY})`);

          // Title
          legend.append("text")
            .attr("class", "legend-title")
            .attr("x", legendWidth / 2)
            .attr("y", titleY)
            .attr("text-anchor", "middle")
            .style("font-size", titleFontSize)
            .style("font-weight", "bold")
            .text("Average Yearly Cases (2016‚Äì2023)");

          // Boxes
          legend.selectAll("rect")
            .data(legendRanges)
            .enter()
            .append("rect")
            .attr("x", (d, i) => i * legendItemWidth)
            .attr("y", 0)
            .attr("width", legendItemWidth)
            .attr("height", 12)
            .attr("fill", d => d.color);

          // Labels
          legend.selectAll("text.legend-label")
            .data(legendRanges)
            .enter()
            .append("text")
            .attr("class", "legend-label")
            .attr("x", (d, i) => i * legendItemWidth + legendItemWidth / 2)
            .attr("y", labelY)
            .attr("text-anchor", "middle")
            .style("font-size", labelFontSize)
            .text(d => d.label);
        }

        // First draw
        drawMap();

        // Redraw on resize
        window.addEventListener("resize", drawMap);

      }).catch(err => {
        console.error("Error loading data:", err);
        document.getElementById("map-table-error").style.display = "block";

        svg.append("text")
      });
    });
  </script>







</body>

</html>